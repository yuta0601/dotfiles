name: OSX

on:
  push:
    branches:
      - main
      - develop
  pull_request:
    branches:
      - main
  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:

jobs:
  deploy-on-OSX-x64:
    runs-on: macos-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v2
      - name: Run deploy.sh
        run: ./deploy.sh -s
        working-directory: ./etc/scripts

  defaults-on-OSX-x64:
    runs-on: macos-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v2
      - name: Run defaults.sh
        run: ./defaults.sh
        working-directory: ./etc/scripts

  source-zshrc-on-OSX-x64:
    runs-on: macos-latest
    env:
      HOME: /Users/runner/work/dotfiles
    steps:
      - name: Checkout
        uses: actions/checkout@v2
      - name: Homebrew UPDATE
        run: brew update
      - name: Install zsh-completions
        run: |
          brew install zsh-completions
          rm -f ~/.zcompdump; compinit
      - name: Install zsh-autosuggestions
        run: brew install zsh-autosuggestions
      - name: Install starship
        run: brew install starship
      - name: Install anyenv
        run: brew install anyenv
      - name: Install pyenv
        run: anyenv install pyenv
      - name: Run source .zshrc
        run: zsh .zshrc
        working-directory: ./zsh/x64
      - name: Run source .zprofile
        run: zsh .zprofile
        working-directory: ./zsh/x64
      - name: Run source .zaliases
        run: zsh .zaliases
        working-directory: ./zsh/x64

          # brew update
          # brew install zsh
  # shellspec-on-OSX-x64:
  #   runs-on: macos-latest
  #   env:
  #     HOME: /Users/runner/work/dotfiles
  #   steps:
  #     - uses: actions/checkout@v2
  #     - name: Run shellspec
  #       run: |
  #         brew update
  #         brew cleanup
  #         brew tap shellspec/shellspec
  #         brew install shellspec
  #         shellspec
