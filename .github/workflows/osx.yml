name: OSX

on:
  push:
    branches:
      - main
      - develop
  pull_request:
    branches:
      - main

jobs:
  deploy-on-OSX-x64:
    runs-on: macos-latest
    steps:
      - uses: actions/checkout@v2
      - name: Run deploy.sh
        run: ./deploy.sh -s
        working-directory: ./etc/scripts

  defaults-on-OSX-x64:
    runs-on: macos-latest
    steps:
      - uses: actions/checkout@v2
      - name: Run defaults.sh
        run: ./defaults.sh
        working-directory: ./etc/scripts

  source-zshrc-on-OSX-x64:
    runs-on: macos-latest
    env:
      HOME: /Users/runner/work/dotfiles
      DOT_DIRECTORY: /Users/runner/work/dotfiles/dotfiles
    steps:
      - uses: actions/checkout@v2
      - name: Run source .zshrc
        run: |
          brew update
          brew install zsh
          source ${DOT_DIRECTORY}/etc/scripts/deploy.sh
          zsh .zshrc
        working-directory: ./zsh
        # shell: zsh

  # shellspec-on-OSX-x64:
  #   runs-on: macos-latest
  #   env:
  #     HOME: /Users/runner/work/dotfiles
  #   steps:
  #     - uses: actions/checkout@v2
  #     - name: Run shellspec
  #       run: |
  #         brew update
  #         brew cleanup
  #         brew tap shellspec/shellspec
  #         brew install shellspec
  #         shellspec
